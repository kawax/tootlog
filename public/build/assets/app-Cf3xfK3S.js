import{f as F,p as W,t as z,d as w,o as s,c as r,a as e,u as t,b as S,e as $,g as f,F as b,r as v,h as A,i as g,n as C,j as J,k as U,l as M,w as q,m as H,q as G}from"./vendor-Dsmaf9Hx.js";function N(a){return F(W(a),"yyyy-MM-dd HH:mm:ss")}function k(a){return z.parse(a)}function T(a){return a.display_name?k(a.display_name):a.username}const I={class:"badge bg-info ms-1"},P=["src"],R=["innerHTML"],K={class:"d-flex m-1 p-1"},Q={class:"flex-shrink-0"},X=["href"],Y=["src"],Z={class:"flex-grow-1 ms-3"},ee=["href","innerHTML"],te={class:"text-muted"},ne=["innerHTML"],oe=["innerHTML"],se=["href"],re=["src"],ae=["href"],le=w({__name:"TimelineReblog",props:{post:{}},setup(a){const c=a,o=c.post.reblog,n=c.post.reblog.account;return(l,_)=>(s(),r("div",null,[e("span",I,[e("img",{class:"rounded-circle toot-icon-small",src:l.post.account.avatar},null,8,P),e("span",{innerHTML:t(T)(l.post.account)},null,8,R),S(" reblogged ")]),e("div",K,[e("div",Q,[e("a",{href:t(n).url,target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},[e("img",{class:"rounded toot-icon",src:t(n).avatar},null,8,Y)],8,X)]),e("div",Z,[e("h4",null,[e("a",{href:t(n).url,innerHTML:t(T)(t(n)),target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},null,8,ee),e("small",te," @"+$(t(n).acct),1)]),t(o).spoiler_text.length>0?(s(),r("button",{key:0,class:"btn btn-warning btn-sm",type:"button",innerHTML:t(k)(t(o).spoiler_text),onClick:_[0]||(_[0]=p=>{t(o).spoiler_text=""})},null,8,ne)):f("",!0),t(o).spoiler_text?f("",!0):(s(),r("div",{key:1,innerHTML:t(k)(t(o).content)},null,8,oe)),t(o).media_attachments?(s(!0),r(b,{key:2},v(t(o).media_attachments,p=>(s(),r("div",null,[e("a",{href:p.url,target:"_blank",ref_for:!0,ref:"nofollow noopener",class:"text-decoration-none"},[e("img",{src:p.preview_url,class:"img-responsive img-thumbnail"},null,8,re)],8,se)]))),256)):f("",!0),e("div",null,[e("a",{href:t(o).url,target:"_blank",ref:"nofollow noopener",class:"text-decoration-none"},$(t(N)(t(o).created_at)),9,ae)])])])]))}}),ie={class:"d-flex p-1 m-1"},ce={class:"flex-shrink-0"},ue=["href"],de=["src"],_e={class:"flex-grow-1 ms-3"},pe=["href","innerHTML"],me={class:"text-muted"},he=["innerHTML"],fe=["innerHTML"],ge=["href"],be=["src"],ve=["href"],ke=w({__name:"TimelineStatus",props:{post:{}},setup(a){const o=a.post.account;return(n,l)=>(s(),r("div",ie,[e("div",ce,[e("a",{href:t(o).url,target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},[e("img",{class:"rounded toot-icon",src:t(o).avatar},null,8,de)],8,ue)]),e("div",_e,[e("h4",null,[e("a",{href:t(o).url,innerHTML:t(T)(t(o)),target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},null,8,pe),e("small",me," @"+$(t(o).acct),1)]),n.post.spoiler_text.length>0?(s(),r("button",{key:0,class:"btn btn-warning btn-sm",type:"button",innerHTML:t(k)(n.post.spoiler_text),onClick:l[0]||(l[0]=_=>{n.post.spoiler_text=""})},null,8,he)):f("",!0),n.post.spoiler_text?f("",!0):(s(),r("div",{key:1,innerHTML:t(k)(n.post.content)},null,8,fe)),n.post.media_attachments?(s(!0),r(b,{key:2},v(n.post.media_attachments,_=>(s(),r("div",null,[e("a",{href:_.url,target:"_blank",ref_for:!0,ref:"nofollow noopener",class:"text-decoration-none"},[e("img",{src:_.preview_url,class:"img-responsive img-thumbnail"},null,8,be)],8,ge)]))),256)):f("",!0),e("div",null,[e("a",{href:n.post.url,target:"_blank",ref:"nofollow noopener",class:"text-decoration-none"},$(t(N)(n.post.created_at)),9,ve)])])]))}}),ye=(a,c)=>{const o=a.__vccOpts||a;for(const[n,l]of c)o[n]=l;return o},$e={},we={class:"card"},xe={class:"card bg-white"};function Me(a,c){return s(),r("div",we,[e("div",xe,[A(a.$slots,"default")])])}const Te=ye($e,[["render",Me]]),He={class:"btn-group pe-1",role:"group"},Le=["onClick","innerHTML"],Se=w({__name:"TypeSwitch",emits:["changed"],setup(a,{emit:c}){const o=c,n=g("public:local"),l={user:'<i class="fa fa-home" aria-hidden="true"></i> User',"public:local":'<i class="fa fa-users" aria-hidden="true"></i> Local',public:'<i class="fa fa-globe" aria-hidden="true"></i> Federated'};function _(p){n.value=p,o("changed",p)}return(p,h)=>(s(),r("div",He,[(s(),r(b,null,v(l,(y,m)=>e("button",{type:"button",class:C(["btn btn-secondary",{active:n.value===m}]),onClick:x=>_(m),innerHTML:y},null,10,Le)),64))]))}}),Ce={class:"btn-group",role:"group"},Ne=["onClick","innerHTML"],Be=w({__name:"MediaSwitch",emits:["changed"],setup(a,{emit:c}){const o=c,n=g("normal"),l={normal:'<i class="fa fa-file-image-o" aria-hidden="true"></i> Media Default',only:'<i class="fa fa-picture-o" aria-hidden="true"></i> Only',except:'<i class="fa fa-commenting-o" aria-hidden="true"></i> Except'};function _(p){n.value=p,o("changed",p)}return(p,h)=>(s(),r("div",Ce,[(s(),r(b,null,v(l,(y,m)=>e("button",{type:"button",class:C(["btn btn-secondary",{active:n.value===m}]),onClick:x=>_(m),innerHTML:y},null,10,Ne)),64))]))}}),Oe={class:"btn-toolbar mb-2",role:"toolbar","aria-label":"toolbar"},je={key:0,class:"alert alert-danger"},De=e("p",null,[e("strong",null,"Whoops!"),S(" Something went wrong!")],-1),Ve=e("hr",null,null,-1),L="/api/v1",Ee=50,Fe={__name:"UserTimeline",props:{domain:String,streaming:String,token:String},setup(a){const c=a,o=g("public:local"),n=g("normal"),l=g([]),_=g([]),p={user:"home","public:local":"public?local=true",public:"public"};let h=null;const y=J(()=>l.value.filter(u=>D(u)));U(()=>m());async function m(u="public:local"){j(),o.value=u;try{const i=await fetch(V()+"/timelines/"+p[u]+"?limit=20",{headers:{Authorization:"Bearer "+c.token}});if(!i.ok)throw new Error(i.status+" "+i.statusText);l.value=await i.json(),x(u)}catch(i){console.error(i),_.value.push(i)}}function x(u="public:local"){O(u,i=>{i.event==="notification"?console.log(i):i.event==="update"&&(l.value.unshift(i.payload),l.value.splice(Ee))})}function O(u,i){h=new WebSocket(E()+"/streaming?access_token="+c.token+"&stream="+u),h.onmessage=d=>{console.log("Got Data from Stream "+u),d=JSON.parse(d.data),d.payload=JSON.parse(d.payload),i(d)},h.onclose=d=>{console.log("WebSocket Close "+u)}}function j(){h!==null&&(h.close(),l.value=[])}function D(u){switch(n.value){case"only":return u.media_attachments.length;case"except":return!u.media_attachments.length;default:return!0}}function V(){return c.domain+L}function E(){return c.streaming+L}return(u,i)=>(s(),r("div",null,[e("div",Oe,[M(Se,{onChanged:m}),M(Be,{onChanged:i[0]||(i[0]=d=>n.value=d)})]),_.value.length>0?(s(),r("div",je,[De,e("ul",null,[(s(!0),r(b,null,v(_.value,d=>(s(),r("li",null,$(d),1))),256))])])):f("",!0),M(Te,null,{default:q(()=>[(s(!0),r(b,null,v(y.value,d=>(s(),r("div",{key:d.id},[d.reblog?(s(),H(le,{key:0,post:d},null,8,["post"])):(s(),H(ke,{key:1,post:d},null,8,["post"])),Ve]))),128))]),_:1})]))}},B=G({});B.component("tt-user-timeline",Fe);B.mount("#app");k(document.body);
