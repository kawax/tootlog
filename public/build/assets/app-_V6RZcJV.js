import{l as W,a as q,f as A,p as F,t as R,o,c as a,b as t,u as s,d as C,e as $,g as f,F as b,r as v,h as z,i as k,n as S,j as J,k as P,m as M,w as U,q as H,s as X}from"./vendor-BKh_N5hN.js";window._=W;window.axios=q;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";function N(e){return A(F(e),"yyyy-MM-dd HH:mm:ss")}function x(e){return R.parse(e)}function T(e){return e.display_name?x(e.display_name):e.username}const G={class:"badge bg-info ms-1"},I=["src"],K=["innerHTML"],Q={class:"d-flex m-1 p-1"},Y={class:"flex-shrink-0"},Z=["href"],ee=["src"],te={class:"flex-grow-1 ms-3"},ne=["href","innerHTML"],oe={class:"text-muted"},se=["innerHTML"],ae=["innerHTML"],le=["href"],re=["src"],ie=["href"],ce={__name:"TimelineReblog",props:{post:Object},setup(e){const n=e.post.reblog.account;return(h,d)=>(o(),a("div",null,[t("span",G,[t("img",{class:"rounded-circle toot-icon-small",src:e.post.account.avatar},null,8,I),t("span",{innerHTML:s(T)(e.post.account)},null,8,K),C(" reblogged ")]),t("div",Q,[t("div",Y,[t("a",{href:s(n).url,target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},[t("img",{class:"rounded toot-icon",src:s(n).avatar},null,8,ee)],8,Z)]),t("div",te,[t("h4",null,[t("a",{href:s(n).url,innerHTML:s(T)(s(n)),target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},null,8,ne),t("small",oe," @"+$(s(n).acct),1)]),e.post.reblog.spoiler_text.length>0?(o(),a("button",{key:0,class:"btn btn-warning btn-sm",type:"button",innerHTML:s(x)(e.post.reblog.spoiler_text),onClick:d[0]||(d[0]=l=>{e.post.reblog.spoiler_text=""})},null,8,se)):f("",!0),e.post.reblog.spoiler_text?f("",!0):(o(),a("div",{key:1,innerHTML:s(x)(e.post.reblog.content)},null,8,ae)),e.post.reblog.media_attachments?(o(!0),a(b,{key:2},v(e.post.reblog.media_attachments,l=>(o(),a("div",null,[t("a",{href:l.url,target:"_blank",ref_for:!0,ref:"nofollow noopener",class:"text-decoration-none"},[t("img",{src:l.preview_url,class:"img-responsive img-thumbnail"},null,8,re)],8,le)]))),256)):f("",!0),t("div",null,[t("a",{href:e.post.reblog.url,target:"_blank",ref:"nofollow noopener",class:"text-decoration-none"},$(s(N)(e.post.reblog.created_at)),9,ie)])])])]))}},ue={class:"d-flex p-1 m-1"},de={class:"flex-shrink-0"},_e=["href"],me=["src"],he={class:"flex-grow-1 ms-3"},pe=["href","innerHTML"],fe={class:"text-muted"},ge=["innerHTML"],be=["innerHTML"],ve=["href"],xe=["src"],ye=["href"],ke={__name:"TimelineStatus",props:{post:Object},setup(e){const n=e.post.account;return(h,d)=>(o(),a("div",ue,[t("div",de,[t("a",{href:s(n).url,target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},[t("img",{class:"rounded toot-icon",src:s(n).avatar},null,8,me)],8,_e)]),t("div",he,[t("h4",null,[t("a",{href:s(n).url,innerHTML:s(T)(s(n)),target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},null,8,pe),t("small",fe," @"+$(s(n).acct),1)]),e.post.spoiler_text.length>0?(o(),a("button",{key:0,class:"btn btn-warning btn-sm",type:"button",innerHTML:s(x)(e.post.spoiler_text),onClick:d[0]||(d[0]=l=>{e.post.spoiler_text=""})},null,8,ge)):f("",!0),e.post.spoiler_text?f("",!0):(o(),a("div",{key:1,innerHTML:s(x)(e.post.content)},null,8,be)),e.post.media_attachments?(o(!0),a(b,{key:2},v(e.post.media_attachments,l=>(o(),a("div",null,[t("a",{href:l.url,target:"_blank",ref_for:!0,ref:"nofollow noopener",class:"text-decoration-none"},[t("img",{src:l.preview_url,class:"img-responsive img-thumbnail"},null,8,xe)],8,ve)]))),256)):f("",!0),t("div",null,[t("a",{href:e.post.url,target:"_blank",ref:"nofollow noopener",class:"text-decoration-none"},$(s(N)(e.post.created_at)),9,ye)])])]))}},$e=(e,u)=>{const n=e.__vccOpts||e;for(const[h,d]of u)n[h]=d;return n},we={},Me={class:"card"},Te={class:"card bg-white"};function He(e,u){return o(),a("div",Me,[t("div",Te,[z(e.$slots,"default")])])}const Le=$e(we,[["render",He]]),Ce={class:"btn-group pe-1",role:"group"},Se=["onClick","innerHTML"],Ne={__name:"TypeSwitch",emits:["typeChanged"],setup(e,{emit:u}){const n=u,h=k("public:local"),d={user:'<i class="fa fa-home" aria-hidden="true"></i> User',"public:local":'<i class="fa fa-users" aria-hidden="true"></i> Local',public:'<i class="fa fa-globe" aria-hidden="true"></i> Federated'};function l(m){h.value=m,n("typeChanged",m)}return(m,g)=>(o(),a("div",Ce,[(o(),a(b,null,v(d,(y,p)=>t("button",{type:"button",class:S(["btn btn-secondary",{active:h.value===p}]),onClick:w=>l(p),innerHTML:y},null,10,Se)),64))]))}},Oe={class:"btn-group",role:"group"},je=["onClick","innerHTML"],Be={__name:"MediaSwitch",emits:["mediaChanged"],setup(e,{emit:u}){const n=u,h=k("normal"),d={normal:'<i class="fa fa-file-image-o" aria-hidden="true"></i> Media Default',only:'<i class="fa fa-picture-o" aria-hidden="true"></i> Only',except:'<i class="fa fa-commenting-o" aria-hidden="true"></i> Except'};function l(m){h.value=m,n("mediaChanged",m)}return(m,g)=>(o(),a("div",Oe,[(o(),a(b,null,v(d,(y,p)=>t("button",{type:"button",class:S(["btn btn-secondary",{active:h.value===p}]),onClick:w=>l(p),innerHTML:y},null,10,je)),64))]))}},De={class:"btn-toolbar mb-2",role:"toolbar","aria-label":"toolbar"},Ee={key:0,class:"alert alert-danger"},Ve=t("p",null,[t("strong",null,"Whoops!"),C(" Something went wrong!")],-1),We=t("hr",null,null,-1),L="/api/v1",qe=50,Ae={__name:"UserTimeline",props:{domain:String,streaming:String,token:String},setup(e){const u=e;let n=null;const h=k("public:local"),d={user:"home","public:local":"public?local=true",public:"public"},l=k("normal"),m=k([]);let g=[];const y=J(()=>m.value.filter(r=>D(r)));P(()=>p());function p(r="public:local"){B(),h.value=r,axios.get(E()+"/timelines/"+d[r]+"?limit=20",{headers:{Authorization:"Bearer "+u.token}}).then(i=>{m.value=i.data,w(r)}).catch(i=>{console.log(i),typeof i.response.data=="object"?g=_.flatten(_.toArray(i.response.data)):g=["Something went wrong. Please try again."]})}function w(r="public:local"){j(r,i=>{i.event==="notification"?console.log(i):i.event==="update"&&(m.value.unshift(i.payload),m.value.splice(qe))})}function j(r,i){n=new WebSocket(V()+"/streaming?access_token="+u.token+"&stream="+r),n.onmessage=c=>{console.log("Got Data from Stream "+r),c=JSON.parse(c.data),c.payload=JSON.parse(c.payload),i(c)},n.onclose=c=>{console.log("WebSocket Close "+r)}}function B(){_.isNull(n)||(n.close(),m.value=[])}function D(r){return l.value==="only"?!_.isEmpty(r.media_attachments):l.value==="except"?_.isEmpty(r.media_attachments):!0}function E(){return u.domain+L}function V(){return u.streaming+L}return(r,i)=>(o(),a("div",null,[t("div",De,[M(Ne,{onTypeChanged:p}),M(Be,{onMediaChanged:i[0]||(i[0]=c=>l.value=c)})]),s(g).length>0?(o(),a("div",Ee,[Ve,t("ul",null,[(o(!0),a(b,null,v(s(g),c=>(o(),a("li",null,$(c),1))),256))])])):f("",!0),M(Le,null,{default:U(()=>[(o(!0),a(b,null,v(y.value,c=>(o(),a("div",null,[c.reblog?(o(),H(ce,{key:0,post:c},null,8,["post"])):(o(),H(ke,{key:1,post:c},null,8,["post"])),We]))),256))]),_:1})]))}},O=X({});O.component("tt-user-timeline",Ae);O.mount("#app");x(document.body);
