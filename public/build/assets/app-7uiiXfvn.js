import{f as D,p as A,t as J,d as w,o as r,c as a,a as t,u as n,b as S,e as $,g as f,F as b,r as g,h as R,i as v,w as F,n as N,j as U,k as q,l as I,m as G,q as x,s as K,v as T,x as P,y as C,z as Q}from"./vendor-BSE4ZHfI.js";function B(s){return D(A(s),"yyyy-MM-dd HH:mm:ss")}function k(s){return J.parse(s)}function H(s){return s.display_name?k(s.display_name):s.username}const X={class:"badge bg-info ms-1"},Y=["src"],Z=["innerHTML"],ee={class:"d-flex m-1 p-1"},te={class:"flex-shrink-0"},ne=["href"],se=["src"],oe={class:"flex-grow-1 ms-3"},re=["href","innerHTML"],ae={class:"text-muted"},le=["innerHTML"],ce=["innerHTML"],ie=["href"],ue=["src"],de=["href"],_e=w({__name:"TimelineReblog",props:{post:{}},setup(s){const l=s,o=l.post.reblog,e=l.post.reblog.account;return(c,_)=>(r(),a("div",null,[t("span",X,[t("img",{class:"rounded-circle toot-icon-small",src:c.post.account.avatar},null,8,Y),t("span",{innerHTML:n(H)(c.post.account)},null,8,Z),S(" reblogged ")]),t("div",ee,[t("div",te,[t("a",{href:n(e).url,target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},[t("img",{class:"rounded toot-icon",src:n(e).avatar},null,8,se)],8,ne)]),t("div",oe,[t("h4",null,[t("a",{href:n(e).url,innerHTML:n(H)(n(e)),target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},null,8,re),t("small",ae," @"+$(n(e).acct),1)]),n(o).spoiler_text.length>0?(r(),a("button",{key:0,class:"btn btn-warning btn-sm",type:"button",innerHTML:n(k)(n(o).spoiler_text),onClick:_[0]||(_[0]=d=>{n(o).spoiler_text=""})},null,8,le)):f("",!0),n(o).spoiler_text?f("",!0):(r(),a("div",{key:1,innerHTML:n(k)(n(o).content)},null,8,ce)),n(o).media_attachments?(r(!0),a(b,{key:2},g(n(o).media_attachments,d=>(r(),a("div",null,[t("a",{href:d.url,target:"_blank",ref_for:!0,ref:"nofollow noopener",class:"text-decoration-none"},[t("img",{src:d.preview_url,class:"img-responsive img-thumbnail"},null,8,ue)],8,ie)]))),256)):f("",!0),t("div",null,[t("a",{href:n(o).url,target:"_blank",ref:"nofollow noopener",class:"text-decoration-none"},$(n(B)(n(o).created_at)),9,de)])])])]))}}),pe={class:"d-flex p-1 m-1"},he={class:"flex-shrink-0"},me=["href"],fe=["src"],be={class:"flex-grow-1 ms-3"},ge=["href","innerHTML"],ve={class:"text-muted"},ke=["innerHTML"],ye=["innerHTML"],$e=["href"],we=["src"],xe=["href"],Me=w({__name:"TimelineStatus",props:{post:{}},setup(s){const o=s.post.account;return(e,c)=>(r(),a("div",pe,[t("div",he,[t("a",{href:n(o).url,target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},[t("img",{class:"rounded toot-icon",src:n(o).avatar},null,8,fe)],8,me)]),t("div",be,[t("h4",null,[t("a",{href:n(o).url,innerHTML:n(H)(n(o)),target:"_blank",rel:"nofollow noopener",class:"text-decoration-none"},null,8,ge),t("small",ve," @"+$(n(o).acct),1)]),e.post.spoiler_text.length>0?(r(),a("button",{key:0,class:"btn btn-warning btn-sm",type:"button",innerHTML:n(k)(e.post.spoiler_text),onClick:c[0]||(c[0]=_=>{e.post.spoiler_text=""})},null,8,ke)):f("",!0),e.post.spoiler_text?f("",!0):(r(),a("div",{key:1,innerHTML:n(k)(e.post.content)},null,8,ye)),e.post.media_attachments?(r(!0),a(b,{key:2},g(e.post.media_attachments,_=>(r(),a("div",null,[t("a",{href:_.url,target:"_blank",ref_for:!0,ref:"nofollow noopener",class:"text-decoration-none"},[t("img",{src:_.preview_url,class:"img-responsive img-thumbnail"},null,8,we)],8,$e)]))),256)):f("",!0),t("div",null,[t("a",{href:e.post.url,target:"_blank",ref:"nofollow noopener",class:"text-decoration-none"},$(n(B)(e.post.created_at)),9,xe)])])]))}}),Te=(s,l)=>{const o=s.__vccOpts||s;for(const[e,c]of l)o[e]=c;return o},He={},Le={class:"card"},Ce={class:"card bg-white"};function Se(s,l){return r(),a("div",Le,[t("div",Ce,[R(s.$slots,"default")])])}const Fe=Te(He,[["render",Se]]),Ne={class:"btn-group pe-1",role:"group"},Be=["onClick","innerHTML"],Ee=w({__name:"TypeSwitch",emits:["changed"],setup(s,{emit:l}){const o=l,e=v("public:local"),c={user:'<i class="fa fa-home" aria-hidden="true"></i> User',"public:local":'<i class="fa fa-users" aria-hidden="true"></i> Local',public:'<i class="fa fa-globe" aria-hidden="true"></i> Federated'};return F(()=>o("changed",e.value)),(_,d)=>(r(),a("div",Ne,[(r(),a(b,null,g(c,(h,i)=>t("button",{type:"button",class:N(["btn btn-secondary",{active:e.value===i}]),onClick:u=>e.value=i,innerHTML:h},null,10,Be)),64))]))}}),Oe={class:"btn-group",role:"group"},Ve=["onClick","innerHTML"],We=w({__name:"MediaSwitch",emits:["changed"],setup(s,{emit:l}){const o=l,e=v("normal"),c={normal:'<i class="fa fa-file-image-o" aria-hidden="true"></i> Text and Media',only:'<i class="fa fa-picture-o" aria-hidden="true"></i> Media',except:'<i class="fa fa-commenting-o" aria-hidden="true"></i> Text'};return F(()=>o("changed",e.value)),(_,d)=>(r(),a("div",Oe,[(r(),a(b,null,g(c,(h,i)=>t("button",{type:"button",class:N(["btn btn-secondary",{active:e.value===i}]),onClick:u=>e.value=i,innerHTML:h},null,10,Ve)),64))]))}});function je(s,l,o,e){const c="/api/v1",d=v([]),h=v([]);let i=null;const u={user:"home","public:local":"public?local=true",public:"public"};U(()=>L()),q(e,()=>{W(),L()});function L(){const{onFetchResponse:m,onFetchError:y}=I(j(),{async beforeFetch({options:p}){return p.headers={...p.headers,Authorization:`Bearer ${o}`},{options:p}}});m(async p=>{d.value=await p.json(),O()}),y(p=>{console.error(p),h.value.push(p)})}function O(){const{close:m}=G(z(),{autoClose:!1,onMessage:(y,p)=>{let M=JSON.parse(p.data);M.payload=JSON.parse(M.payload),V(M)},onConnected(y){console.debug("WebSocket Open "+s+" "+x(e))},onDisconnected(y,p){console.debug("WebSocket Close "+s)},onError(y,p){console.debug("WebSocket Error "+s+" "+x(e))}});i=m}function V(m){switch(m.event){case"update":d.value.unshift(m.payload),d.value.splice(50);break;default:console.debug(m)}}function W(){i!==null&&i(),d.value=[]}function j(){return s+c+"/timelines/"+u[x(e)]+"?limit=20"}function z(){return l+c+"/streaming?access_token="+o+"&stream="+x(e)}return{posts:d,errors:h}}function ze(s,l){switch(l){case"only":return s.media_attachments.length>0;case"except":return s.media_attachments.length===0;default:return!0}}const De={class:"btn-toolbar mb-2",role:"toolbar","aria-label":"toolbar"},Ae={key:0,class:"alert alert-danger"},Je=t("p",null,[t("strong",null,"Whoops!"),S(" Something went wrong!")],-1),Re=t("hr",null,null,-1),Ue=w({__name:"UserTimeline",props:{domain:{},streaming:{},token:{}},setup(s){const l=s,o=v("public:local"),e=v("normal"),{posts:c,errors:_}=je(l.domain,l.streaming,l.token,o),d=K(()=>c.value.filter(h=>ze(h,e.value)));return(h,i)=>(r(),a("div",null,[t("div",De,[T(Ee,{onChanged:i[0]||(i[0]=u=>o.value=u)}),T(We,{onChanged:i[1]||(i[1]=u=>e.value=u)})]),n(_).length>0?(r(),a("div",Ae,[Je,t("ul",null,[(r(!0),a(b,null,g(n(_),u=>(r(),a("li",null,$(u),1))),256))])])):f("",!0),T(Fe,null,{default:P(()=>[(r(!0),a(b,null,g(d.value,u=>(r(),a("div",{key:u.id},[u.reblog?(r(),C(_e,{key:0,post:u},null,8,["post"])):(r(),C(Me,{key:1,post:u},null,8,["post"])),Re]))),128))]),_:1})]))}}),E=Q({});E.component("tt-user-timeline",Ue);E.mount("#app");k(document.body);
